from datetime import datetime
from cve_monitor.logging import logger
from flask_apscheduler import APScheduler
from cve_monitor.twitter import tweet_feed


def twitter_task():
    try:
        tweet_feed()
    except Exception as ex:
        logger.warning(str(ex))
    else:
        return None


def schedule_task():
    now = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    logger.warning(f"{now} - Starting a schedule job")
    twitter_task()


def schedule_start():
    scheduler = APScheduler()
    scheduler.add_job(id="Scheduled Task", func=schedule_task, trigger="interval", hours=3)
    scheduler.start()
